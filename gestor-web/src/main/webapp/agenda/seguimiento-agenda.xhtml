<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"                
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://java.sun.com/jsf/core"
                template="/template.xhtml"
                >

    <ui:define name="content">
        <h:form enctype="multipart/form-data" style="font-size: small;">
            <p:remoteCommand name="cargarAgendaSeguimiento" action="#{uiSeguimientoAgenda.cargarAgendaSeguimiento()}" update="form-seguimiento" 
                             autoRun="true"/>
            <div align="right">
                <p:commandButton icon="ui-icon-refresh" oncomplete="cargarAgendaSeguimiento();" style="width: 50px; height: 50px;">
                    <f:setPropertyActionListener value="" target="#{uiSeguimientoAgenda.agendaPacientesList}"/>
                </p:commandButton>
            </div>
            <br/>
        </h:form>
        <h:form  enctype="multipart/form-data" id="form-seguimiento" style="font-size: small;">
            <h:panelGroup id="pg-seguimiento">
                <p:panel  header="Seguimiento Agendas">
                    <p:dataTable var="varAgendaSeguimiento" value="#{uiSeguimientoAgenda.agendaPacientesList}" rowStyleClass="Centro"  widgetVar="widgetvarAgendaSeguimiento"
                                 emptyMessage="No se encuentran agendas para seguimiento" rows="10" paginator="true" filterEvent="enter"
                                 selectionMode="single" selection="#{uiSeguimientoAgenda.agendaPacientes}" rowKey="#{varAgendaSeguimiento.agendaPacientesPK.codAgenda}"
                                 sortBy="#{varAgendaSeguimiento.agendaPacientesPK.codAgenda}" sortOrder="descending"
                                 >
                        <p:column headerText="Cod Agenda" filterBy="#{varAgendaSeguimiento.agendaPacientesPK.codAgenda}"  filterMatchMode="contains"
                                  sortBy="#{varAgendaSeguimiento.agendaPacientesPK.codAgenda}" filterable="true"> 
                            <h:outputText value="#{varAgendaSeguimiento.agendaPacientesPK.codAgenda}" />
                        </p:column> 

                        <p:column headerText="Usuario" filterBy="#{varAgendaSeguimiento.usuario}"  filterMatchMode="contains"
                                  sortBy="#{varAgendaSeguimiento.usuario}" filterable="true">
                            <h:outputText value="#{varAgendaSeguimiento.usuario}" />
                        </p:column>

                        <p:column headerText="Estado" filterBy="#{varAgendaSeguimiento.estado}"  filterMatchMode="contains"
                                  sortBy="#{varAgendaSeguimiento.estado}" filterable="true">
                            <h:outputText value="#{varAgendaSeguimiento.estado}" />
                        </p:column>

                        <p:column headerText="Fecha CreaciÃ³n" filterBy="#{varAgendaSeguimiento.fechaRegistro}"  filterMatchMode="contains"
                                  sortBy="#{varAgendaSeguimiento.fechaRegistro}" filterable="true">
                            <h:outputText value="#{varAgendaSeguimiento.fechaRegistro}" >
                                <f:convertDateTime pattern="dd/MM/yyyy hh:mm:ss a" timeZone="America/Bogota"/>
                            </h:outputText>
                        </p:column>
                    </p:dataTable>
                </p:panel>
            </h:panelGroup>

            <h:panelGrid>
                <ui:include src="/barra.xhtml">
                    <ui:param name="bean" value="#{uiSeguimientoAgenda}"/>
                </ui:include>
            </h:panelGrid>

            <p:dialog id="dialog" widgetVar="dialog" header="#{sesion.dialogo.header}" showEffect="#{sesion.dialogo.effect}" hideEffect="#{sesion.dialogo.effect}"
                      onHide="limpiarModal()">
                <ui:include src="#{sesion.dialogo.src}"/>
            </p:dialog>
            <p:remoteCommand name="limpiarModal" action="#{uiSesion.limpiarDialogo()}" update="dialog" />
        </h:form>

    </ui:define>

</ui:composition>
